<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Eh</title>
    <link rel="stylesheet" href="css/bootstrap.min.css"/>
    <meta name="viewport" content="initial-scale=1.0">
    <script type="text/javascript" src="js/jquery-3.3.1.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <style media="screen" type="text/css">
      * {
        margin:0;
        padding:0
      }

      body {
        background-color: #DDD;
      }

      #mainContainer {
        width: 800px;
        margin: 50px auto 0 auto;
        border:1px solid #888;
        background-color: #FFF;
      }

      #canvasContainer {
        text-align: center;
      }

      #c {
        margin:0 auto 0 auto;
          border:1px solid #000;
      }
    </style>
  </head>
  <body>
    <div id="mainContainer">
      <h1>Eh</h1>
      <div class="">
        <input type="text" id="loadProfUrl" value="https://www.ratemyprofessors.com/ShowRatings.jsp?tid=860888" placeholder="https://www.ratemyprofessors.com/ShowRatings.jsp?tid=860888">
        <input type="button" id="loadProfButton" value="Load">
      </div>
      <div id="canvasContainer">
        <h1 id="profName"></h1>
        <h2 id="uniName"></h2>
        <canvas id="c" width="500px" height="700px"></canvas>
        <script type="text/javascript">
          $(document).ready(function() {
            var $profName = $('#profName')
            var $uniName = $('#uniName')

            var $loadProfUrl = $('#loadProfUrl')
            var $loadProfButton = $('#loadProfButton')

            $loadProfButton.on('click', function() {
              var profUrl = $loadProfUrl.val()

              console.log(profUrl)

              $.ajax({
                url: profUrl,
                type: 'GET',
                crossDomain: true,
                dataType: 'html',
                success: function (response) {
                  var strippedResponse = response.replace(/src=/gi, 'nosrc=')
                  var $html = $(strippedResponse)

                  var titleA = $html.filter('title').text().split(' at ')
                  var profName = titleA[0]
                  var uniName = titleA[1].split(' - RateMyProfessors.com')[0]

                  $profName.html(profName)
                  $uniName.html(uniName)

                }
              });
            });
          });


          var canvas = document.getElementById('c');
          var ctx = canvas.getContext('2d');

          ctx.strokeStyle = '#FF0000';
          ctx.lineWidth = 5;

          var drawing = false;

          function getXY(e) {
            var x, y;
          	// Get the mouse position relative to the <canvas> element
          	if (e.layerX || e.layerX == 0) { // Firefox
          		x = e.layerX;
          		y = e.layerY;
          	} else if (e.offsetX || e.offsetX == 0) { // Opera
          		x = e.offsetX;
          		y = e.offsetY;
          	}

            return { x: x, y: y }
          }

          canvas.addEventListener('mousedown', function(e) {
            var xy = getXY(e)

            drawing = true;

            ctx.beginPath();
            ctx.moveTo(xy.x, xy.y);

          }, false);

          canvas.addEventListener('mouseup', function(e) {
            drawing = false;

            ctx.closePath();

          });

          canvas.addEventListener('mousemove', function(e) {
            if(drawing == true) {
              var xy = getXY(e)

              ctx.lineTo(xy.x, xy.y);
              ctx.stroke();
            }
          });

        </script>
      </div>
      <div id="footer">
        adfads
      </div>
    </div>
  </body>
</html>
